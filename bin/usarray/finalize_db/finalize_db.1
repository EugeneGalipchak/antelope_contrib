.TH FINALIZE_DB 1 "$Date$"
.SH NAME
finalize_db \- build descriptor file, clean db, and dbverify
.SH SYNOPSIS
.nf
\fBfinalize_db \fP [-d] [-n] [-t] [-p pf] db1 [ db2 db3 ... ] 
.fi
.SH DESCRIPTION
\fBfinalize_db\fP creates a descriptor file, cleans up the database, and runs dbverify.
The this program is used to build a consistent archive of monthly or yearly databases. 

Cleanup functions in \fBfinalize_db\fP include:

.IP "dbcrunch"
.IP "remove \fIdel\fP arrivals"
.IP "fix $db.arrival snr < 0"
.IP "sort arrival and origin table by time"
.IP "dbfix ids for orid, arid, evid, magid"
.IP "dbfixchanids"
.IP "set calib, calper, segtype"

.LP

.SH OPTIONS
.IP -v
verbose
.IP -d
only create descriptor file
.IP -t
only tidy up db, do not make descriptor file
.IP "-p parameter_file"
Name of parameter file to use.  $PFPATH is searched to find parameter file.
The default parameter file is \fBfinalize_db\fP.

.SH ENVIRONMENT
needs to have sourced $ANTELOPE/setup.csh.  
.SH PARAMETER FILE
.in 2c
.ft CW
.nf
.ne 7
.IP dbidserver
Name of idserver to be written into descriptor file for output database to use.
.IP dbpath    
dbpath to be written into descriptor file for output database to use.
.IP dblocks
dblocking type for database
.fi
.ft R
.in
.SH EXAMPLE PARAMETER FILE
.in 2c
.ft CW
.nf

dbpath				../dbmaster/{nw}	# default dbpath
dbidserver			localhost:	        # default dbidserver
dblocks				local               # default dblocks

.fi
.ft R
.in
.SH RETURN VALUES
0 if successful, 1 if not.
.SH "SEE ALSO"
.nf
dbcrunch(1)
dbfixids(1)
dbfixchanids(1)
dbsort(1)
dbverify(1)
.fi
.SH "BUGS AND CAVEATS"
none
.LP
.SH AUTHOR
Frank Vernon
.br
