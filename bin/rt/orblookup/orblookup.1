# This is a template for a standard Antelope man page.  
# After you've filled in the necessary fields, 
# delete the lines beginning with "#"
# with a command like: "sed '/^#/d'". 
#
# Look at your formatted man page after installing it, using man.
#
# If you write a man page which describes several routines 
# or commands, you should have a man "page" named after each routine or 
# command.  One will have the actual description in it, the others will
# just include the first with a line like:
# .so man3/malloc.3v
#
# The following line is for man pages which use tbl or eqn; it 
# causes man to run tbl and/or eqn on the man page.  If the man page
# doesn't require these, the line should be deleted.
#'\" te
#
# Fill in TITLE in all caps -- SECTION# can be 1 3 3F or 5
#
.TH ORBLOOK 1 "$Date$"
#
.SH NAME
#
# For a command manpage, put the command name and brief description next;
# eg,  "ls \- list directory"
# For a set of subroutines, put each subroutine name separated by commas, 
# followed by the brief description.
# eg, "malloc, free, realloc \- memory allocator"
# name (lowercase roman) \- a pithy description of the subject
orblook \- Controls cacheing of orblookup web page data

.SH SYNOPSIS
#.nf
#
# Put the usage line for a command. 
# For a library, put the calling sequence and argument declarations for 
# each subroutine.  Be sure to specify any necessary include files,
# as well as the actual library name.  
# exact command (bold), options (square brackets bold, use | to separate 
# alternative options), arguments (square brackets italics)
.ll +8
orblook
start
.I orbname 
.I interval
.ll -8
.br
orblook
stop
.I orbname 
.ll -8
.br
orblook
restart
.I orbname 
.I interval
.ll -8
.br

#
.fi
.SH DESCRIPTION
#
# Here you put the complete description. Use .SS for subsections, .LP
# for paragraphs.
# The names of programs and command options must be in bold. 
# The names of parameters and arguments should be in italics.
#
Orblook controls the cacheing of orb packet source data for the orblookup cgi
program.
.LP 
Orblook can start, stop, or restart the process retrieving data for 
a particular orb.  This data is stored in a parameter file in human-readable 
format. 
.LP
Orblookup is a cgi program that outputs this data in html format.  When placed 
in the web tree and given executable permissions by the web server, 
orblookup can be navigated to and its output can be viewed in a web browser.  
Data from this page is updated on a regular interval, so the viewer's web 
browser will automatically refresh with the newest data available to it.

.SH OPTIONS
#
# Options in bold. Describe options from \fBSYNOPSYS\fR above in fully
# indented paragraphs, preceded by the option.
#
.IP "start \fIorbname\f \fIinterval\f"
Starts retrieving data for orb \fIorbname\f every \fIinterval\f minutes and
cacheing it in the temporary cache files.  For orbs containing large
amounts of data, and for small intervals, it may take longer to complete retrieval and analysis than the interval given;  in these cases, the new retrieval will
not start until the current retrieval is complete.
.IP "stop \fIorbname\f"
Stops the retrieval of data for orb \fIorbname.\f
.IP "restart \fIorbname\f \fIinterval\f"
Stops, and then starts, retrieval of data for the orb \fIorbname\f every
\fIinterval\f minutes.

.SH FILES
/tmp/cache_\fIorbname\f
.br
Contains the cached packet data grabbed from orb \fIorbname.\f  This location
is a default and may be different on your system.  This should not ever be 
edited by the end user except in cases of catastrophic failure, in which case 
it can be simply deleted.  Deleting will cause the orblookup cgi program to 
generate an error page when viewed until the cache is regenerated by orblook.
#
# Describe input and output files (but not down to bits).
#
.SH PARAMETER FILE

#
# Describe any parameter file
#
.TP
orblookup.pf
Two items of importance exist in the orblookup configuration file: the orblist,
and the html template.
.TP
The orb list
.br
The first item of importance in the orblookup configuration file is the list
of orbs to be monitored, containing the orb names, packet types to be
scanned, the alert messages to be used, the fields to be displayed, and fields
to be ignored for particular packet types.
.TP
The HTML Template
.br
The template element contains blocks of valid html code with special comments 
designed to act as placeholders for variables.  At least one block of code 
must be contained by html_template: the overview element.  This is the first 
block of code processed, and if no references to other blocks are contained 
with it, may be the only block of code processed.
.LP
The orblookup program steps through the overview string literal and substitutes 
generated code at special comments encountered.  There are three specific       
comment types used by orblookup, with the following format:  
.LP
1) <!-- ?variable_name -->
.br
which is replaced by the value of the given variable, where variable_name 
is a legal variable name listed below:
.LP
.nf
orbname            the name of the current orb
minnetlat          the smallest latency on the current network
mediannetlat       the median latency on the current network          
maxnetlat          the largest latencies seen on the current network
alertmode          " checked" if displaying only alerts, "" otherwise
staclass           class corresponding for current station
netclass           class corresponding to current network
time               the time in UTC of the last cache
encodednet         the network in scope in url-encoded form
encodednetsta      the sta+network in url-encoded form
alert_class        class corresponding to the current alert state
alert_desc         full description of the alert state
rownumclass        an alternating class name, either .oddrow or .evenrow
fieldclass         the class of the current field
fieldvalue         the value of the current field
fieldalign         the alignment of the current field, based on config
checkedstatus      replaced by "checked" or nothing depending on field
scriptname         the url of the current page
percentcolwidth    the reciprocal of the number of columns as a percent
net                name of the network currently in scope
sta                name of the station currently in scope
used_field         the name of the current field that is enabled
all_field          the name of the current field
num_used_fields    # of fields current enabled
numfields          total # of fields defined for a network
num_nets           total # of networks used
numstas            total # of stations on current network
numstastot         total # of stations on all networks
numstas_expected   total # of expected stations on current network    
numchans           # of channels found for the current station
numchanstot        total # of channels on current network
url                url for the current network
orburl             url for the current orb
orb                name of the current orb
.fi
.LP
.na
2) <!-- ?insert block_name iterate=num indent=num_spaces -->
.br
.ad
which is replaced by a block of code contained in block_name and is 
indented num_spaces, where block_name is a top-level component under
html_template.  This performes num iterations of the block of code.
.LP
.na
3) <!-- ?insert block_name iterate=variable_name indent=num_spaces -->
.br
.ad
which is replaced by a block of code iterated over variable_name and
indented num_spaces, where variable_name is a legal variable name listed
below, and has an integer value.  This loops over the variable
variable_name, and updates its value through each iteration.  The valid
variable names for this purpose are:
.LP
.IP
      net
      sta
      used_field
      all_field
      alert_stage
      orb
.SH EXAMPLE
% orblook start igpprt:anza
.br
Starting orb igpprt:anza at an interval of 6
.PP
% orblook stop igpprt:anza
.br
orblook on igpprt:anza stopped.
.PP
% orblook restart igpprt:anza 36
.br
orblook on igpprt:anza stopped.
Restarting orb igpprt:anza at an interval of 36

#
# This section should contain an example that the user can follow
# verbatim.  For a command, this should show a sample command line and output.
# Use the same fonts as in \fBSYNOPSIS\fR. What the user types in should
# be bold, and program response or output should be roman. All commands 
# should be preceded by a representative UNIX prompt.
#
# For a library, you might show an example program (This is usually only 
# done for more complex routines or packages.)
#
.SH RETURN VALUES
orblook returns 0 for normal execution and -1 if the command can't be carried 
out, accompanied by an error message describing the reason for the command 
failure.
#
# Describe the return values for each subroutine or command.  The usual
# is to return 0 for normal execution and something else for errors.
#
#
# Describe error messages and give cautionary advice.
.SH "SEE ALSO"
.nf
orbstat(1)
#
# List related manual entries and section (lowercase, bold)., eg "file(1)"
# or related documents
.fi
#
# Describe any shortcomings of the programs, known bugs, or surprising 
# results.
.SH AUTHOR
.nf
Jennifer Bowen
.br
Institute of Geophysics and Planetary Physics
.br
Scripps Institution of Oceanography

.fi
# Put the author's name here (person who wrote the code) (roman).
# This is just an id line from rcs.
.\" $Id$
